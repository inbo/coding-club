---
layout: presentation
title: From stand alone functions to R packages
---

class: center, middle

![:scale 30%]({{ site.baseurl}}/assets/images/coding_club_logo_1.png)

<!-- Do not forget to adapt the presentation title in the header! -->

<!-- Adjust the presentation to the session. Focus on the challenges,
    this is not a coding tutorial.

    Note, to include figures, store the image in the `/docs/assets/images/yyyymmdd/`
    folder and use the jekyll base.url reference as done in this template
    or see https://jekyllrb.com/docs/liquid/tags/#links.
    using the scale attribute ![:scale 30%](...), you can adjust the image size.
-->

<!--  Adjust the day, month  -->
# 29 OCTOBER 2024

## INBO coding club

<!--  Adjust the room number and name  -->
Herman Teirlinck Building

01.17 - Clara Peeters

---
class: left, top

# Big news: new website URL

The INBO coding club website has a new, INBO branded URL: [coding-club.inbo.be/](https://coding-club.inbo.be/). The old URL ([inbo.github.io/coding-club/](https://inbo.github.io/coding-club/)) will be redirected to the new one.

Notice that the same change has been made for the INBO tutorials website: [tutorials.inbo.be/](https://tutorials.inbo.be/). The old URL ([inbo.github.io/tutorials/](https://inbo.github.io/tutorials/)) will be redirected to the new one.

---
class: left, top

# Big news: bye bye Amber

Amber, member of the INBO coding club core team, will leave INBO soon. We will miss her a lot. We wish her all the best in her new job and life in the land of tea and [scones](https://en.wikipedia.org/wiki/Scone). We hope she will continue to be part of the coding club community, even if remotely.

.center[![:scale 30%]({{ site.baseurl}}/assets/images/20241029/20241029_bye_bye_Amber.webp)]


<small>Public domain picture from [rawpixel](https://www.rawpixel.com/image/2597076/free-illustration-image-bye-ballon-black). </small>

---
class: center, middle

<!-- Create a new badge using Inkscape or other programs based on the assets/images/coding_club_badges.svg file -->
![:scale 90%]({{ site.baseurl}}/assets/images/20241029/20241029_badge.png)



---
class: left, top

# Recap: coding is cooking

- R is your kitchen
- R console is your food processor.
- Functions are like recipes: they tell you how to take inputs (ingredients), process them in some way and return an output (food).

---
class: left, top

# Recap: define the function

- Define the recipe to make bread in the food processor settings
- Define the function `make_bread()`

```
make_bread <- function(grains, yeast, water, salt) {
    # Code to generate `bread`.
    # The code here can be easy (easy bread recipes do exist)
    # or quite complex (complex bread recipes do exist too)
    bread <- grains + yeast + water + salt
    return(bread)
}
```

---
class: left, top

# Recap: use the function

- When ready, you can add ingredients to the food processor, select your own recipe, press `Play` and you will get the **food**.
- When ready, you can pass inputs to the function, call your own function, press `Enter` and you will get the **output**.

```
# Prepare ingredients on the table = Define input values
g <- 20
y <- 1
w <- 2
s <- 3
# Add ingredients in the food processor = Pass input values to arguments of the function
bread <- make_bread(
  grains = g,
  yeast = y,
  water = w,
  salt = s
) # Press `Enter`
bread
```

---
class: left, top

# Recap: multiple outputs?

Answer is NO.

- One recipe = one food
- One function = one output

Still, the output can be a named list containing multiple elements.

---
class: left, top

# Recap: how to load your stand alone functions?

Separate the functions from the code which calls them. Save the functions in a R file, e.g. `make_meals.R`. This allows you to **SOURCE** this file, e.g. by running `source("make_meals.R")` or just by clicking the "Source" button in RStudio.


.center[![:scale 100%]({{ site.baseurl}}/assets/images/20241029/20241029_source_functions.png)]

---
class: left, top

# Recap: document your functions

- Use the `roxygen2` package to document your functions. This will help future-you to understand what the function does, what the arguments are, what the output is, and how to use the function.
- You can create a roxygen documentation Skeleton via `Code` -> `Insert Roxygen Skeleton`. You will need this today as well!

.center[![:scale 60%]({{ site.baseurl}}/assets/images/20241029/20241029_insert_skeleton_documentation.png)]


---
class: left, top

# Recap: style your functions

- [INBO Styleguide for R code](https://inbo.github.io/tutorials/tutorials/styleguide_r_code/): the official guide followed by us at INBO.
- The [tidyverse style guide](https://style.tidyverse.org/documentation.html): a widely used and generic enough guide. All tidyverse packcages follow it.
- The [B-cubed software development guide](https://docs.b-cubed.eu/dev-guide/) mostly written by our colleague, Pieter. A very good guide covring all different aspects of software development (for both R and Python) also focussed on metadata.

---
class: center, top

### How to get started?

Check the [Each session setup](https://inbo.github.io/coding-club/gettingstarted.html#each-session-setup) to get started.

### First time coding club?

Check the [First time setup](https://inbo.github.io/coding-club/gettingstarted.html#first-time-setup) section to setup.

---
class: left, top

![:scale 100%]({{ site.baseurl}}/assets/images/coding_club_sticky_concept.png)


---
class: center, middle

# Share your code during the coding session

<!-- Create a new hackmd file and replace this link (twice!) -->
Go to https://hackmd.io/cbAR638FR7CQJmoP7rSgdA?both and start by adding your name in section "Participants".

<iframe src="https://hackmd.io/cbAR638FR7CQJmoP7rSgdA?edit" height="400px" width="800px"></iframe>

---
class: left, top

# Download data and code

You can download the material of today:

- automatically via `inborutils::setup_codingclub_session()`*

- manually** from GitHub folders [coding-club/data/20241029](https://github.com/inbo/coding-club/tree/master/data/20241029) and [coding-club/src/20241029](https://github.com/inbo/coding-club/tree/master/src/20241029)

<br>
<small> __\* Note__: you can use the date in "YYYYMMDD" format to download the coding club material of a specific day, e.g. run `setup_codingclub_session("20201027")` to download the coding club material of October, 27 2020. If date is omitted, the date of today is used. For all options, check the [tutorial online](https://inbo.github.io/tutorials/tutorials/r_setup_codingclub_session/).</small>
<br>
<small> __\*\* Note__: check the getting started instructions on [how to download a single file](https://inbo.github.io/coding-club/gettingstarted.html#each-session-setup)</small>


---
class: left, top

# From functions to packages

- A package is a collection of (documented) functions.
- A package is a very good way to organize and share your functions.

If a function is like a recipe, a package is like a well-organised bundle of recipes, a cookbook!

![:scale 60%]({{ site.baseurl}}/assets/images/20241029/20241029_cookbook.jpg)

<br>
<small>Credits for the [picture](https://pixabay.com/nl/photos/kookboek-oud-recepten-voorbereiding-982661/): [Petra](https://pixabay.com/nl/users/ptra-359668/) on [pixabay](https://pixabay.com/en/).</small>


---
class: center, middle

![:scale 90%]({{ site.baseurl}}/assets/images/20241029/20241029_package-development_cheatsheet.png.png)
Download cheatsheet [pdf](https://github.com/inbo/coding-club/blob/master/cheat_sheets/20241029_package-development.pdf)* or go to the [HTML version](https://rstudio.github.io/cheatsheets/html/package-development.html).

<br>
<small><left> \* PDF cheatsheet is available in other 6 languages, e.g. [Dutch](https://rstudio.github.io/cheatsheets/translations/dutch/package-development_nl.pdf) and [Italian](https://rstudio.github.io/cheatsheets/translations/italian/package-development_it.pdf).</left></small>

---
class: left, top

# Challenge 0 - How to create a R package

Let's start a R package in RStudio!

Go to `File` -> `New Project` -> `New Directory` -> `R package using devtools`

![:scale 80%]({{ site.baseurl}}/assets/images/20241029/20241029_select_project_type.png)

---
class: left, top

# Challenge 0 - How to create a R package

In the new pop-up window choose:

- `Directory name`: the name of the package, e.g. `fiRst`
- `Create project as subdirectory of`: place it where you prefer, e.g. in your `src/20241029/` subdirectory.*
- Yes, select `"Open in new session"`, always a good idea.

![:scale 75%]({{ site.baseurl}}/assets/images/20241029/20241029_create_project.png)

---
class: left, top

# Challenge 0 - How to install a R package?

Stand alone functions ae _loaded_ by `Source` button (or `source()` commando). A package needs to be _installed_ and _loaded_. To do so, you have a pane in RStudio called `Build`.

- Click on the `Build` pane.
- Click on `Install`: it will install the package, restart R and load the package (run `library(fiRst)`) automatically.

![:scale 60%]({{ site.baseurl}}/assets/images/20241029/20241029_build_install.png)


---
class: left, top

# Challenge 1

1. As any book, also a cookbook has more than just a title: it has an author, a short description and important **metadata**, e.g. publisher and IBAN number.
Every R package has an essential file for this: `DESCRIPTION`. It contains metadata about the package, including the package name, version, author, and dependencies (packages yours depends on). Open it and edit it. Set yourself as **aut**hor and **cre**ator. About license, choose the `MIT` license or the  `GPL-3` license.*
2. Installing is one thing. Another important operation is checking your package. It helps you to detect issues with your package. Click on `Check` in the `Build` pane. What do you see?
3. Typically a cookbook has at least one recipe :-) Well, packages have at least one function. Our package? Not yet :-) R files with functions `MUST` be placed in the `./R` folder. Place the functions `make_bread()` and `make_focaccia()` in `./R` folder. Best practice: one function = one file, and `file_name` = `function_name`.
4. Try to install your package once again. Can you use your new functions? Try to find why and solve the issue. Hint: documentation is more than just a nice-to-have.


![:scale 60%]({{ site.baseurl}}/assets/images/20241029/20241029_check.png)

<br>
<small> \* For more information about software dedicated licenses, check the [choosealicense.com](https://choosealicense.com/) website. The proposed licenses are two open licenses typically used for code at INBO.  </small>

---
class: left, top

# Intermezzo 1 - recap

We learned three important functions of the devtools package. They do a lot of things for you:
- `devtools::install()` is the commando behind the button `Install` in the Build pane to install the package.
- `devtools::check()` is the commando behind the button `Check` in the Build pane to check the package.
- `devtools::document()` is the commando behind Other -> Documentation (Ctrl + Shift + D) to generate the documentation for your functions.

---
class: left, top

# Intermezzo 1 - usethis


You wonder: if I can use devtools commandos to install/check/document my package, why is there no commando to create a package? Why must I click here and there in RStudio to do so? Well, there is a package for that: `usethis`. It is a brother package of devtools that automates many tasks for you. For example, you can create the very same package described in challenge 0 with `usethis::create_package("path/to/package")`!

So, if you are in the console of the coding club project (root folder), and you want to create a package, let's say `secondR` in the `src/20241029/` folder, you can run:

```
usethis::create_package("src/20241029/secondR")
```


---
background-image: url({{ site.baseurl}}/assets/images/background_challenge_2.png)
class: left, top

# Challenge 2

1. We want to create a new package called `bRead`. Check if your package name is available on CRAN, GitHub, Bioconductor. That is important because you do not want to have the same name as another package. Is it an abbreviation? Is it a name that is easy to remember? Is it a name that is easy to type? Hint: session [Naming your package](https://docs.b-cubed.eu/dev-guide/#r-pkg-naming) from the B-Cubed software dev guide.
2. Create a new package called `bRead` (either via RStudio or via usethis).
3. Add MIT license. While doing this, please add ÌNBO as copyright holder (or the organisation you belong to).
4. Add your neigbour to the authors with role contributor.
5. Add code of counduct and contributing guidelines.


---
class: left, top

# Challenge  3


---
class: left, top

# The package of the month



---
class:left, top

# Resources

- Challenges solutions and the edited video recording will be available soon.
- The [INBO styleguide for R code](https://inbo.github.io/tutorials/tutorials/styleguide_r_code/).
- The [B-Cubed software development guide](https://docs.b-cubed.eu/dev-guide/).
- Some advices from [tidyverse style guide](https://style.tidyverse.org/documentation.html) can also be useful.
- Packages [Roxygen2](https://roxygen2.r-lib.org/index.html) and [docstring](https://github.com/dasonk/docstring).
- The [checklist](https://packages.inbo.be/checklist/index.html) package: a set of checks for R projects and R packages.
- The [usethis](https://usethis.r-lib.org/index.html) package: a workflow package, useful for both R packages and projects.
- The [devtools](https://devtools.r-lib.org/index.html) package: a package development package.

---
class: center, middle

![:scale 30%]({{ site.baseurl}}/assets/images/coding_club_logo_1.png)

<!--  Adjust the room and date  -->
Room: 01.23 - Léon Stynen <br>
Date: __28/11/2024__, van 10:00 tot 12:30<br>
Subject: To be decided <br>
(registration announced via DG_useR@inbo.be)
